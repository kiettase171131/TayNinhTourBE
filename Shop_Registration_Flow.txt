================================================================================
                    FLOW ƒêƒÇNG K√ù SPECIALTY SHOP - TAYNINHTOURBE
                              [UPDATED AFTER SHOP MERGE]
================================================================================

üìã T·ªîNG QUAN
============
Flow ƒëƒÉng k√Ω cho ph√©p User ƒëƒÉng k√Ω tr·ªü th√†nh Specialty Shop Owner ƒë·ªÉ qu·∫£n l√Ω
shop ƒë·∫∑c s·∫£n tham gia v√†o h·ªá sinh th√°i tour du l·ªãch T√¢y Ninh.

üîÑ FLOW CH√çNH
=============
1. User Registration (Role: "User")
2. SpecialtyShop Application Submission
3. Admin Review Process
4. Approval/Rejection Decision
5. Role Update to "Specialty Shop"
6. SpecialtyShop Entity Creation
7. SpecialtyShop Management

üìä DATABASE SCHEMA
==================

SpecialtyShopApplication Entity:
--------------------------------
- Id (Guid, PK)
- UserId (Guid, FK to User) - ng∆∞·ªùi ƒëƒÉng k√Ω
- ShopName (string, required) - t√™n specialty shop
- ShopDescription (string, optional) - m√¥ t·∫£ specialty shop
- BusinessLicense (string, required) - s·ªë gi·∫•y ph√©p kinh doanh
- Location (string, required) - ƒë·ªãa ch·ªâ specialty shop
- PhoneNumber (string, required) - s·ªë ƒëi·ªán tho·∫°i
- Email (string, required) - email li√™n h·ªá
- Website (string, optional) - website specialty shop
- ShopType (string, optional) - lo·∫°i shop (Souvenir, Food, Craft...)
- BusinessDocuments (string, optional) - link t√†i li·ªáu kinh doanh
- Status (enum) - tr·∫°ng th√°i ƒë∆°n (Pending/Approved/Rejected)
- RejectionReason (string, nullable) - l√Ω do t·ª´ ch·ªëi
- SubmittedAt (DateTime) - th·ªùi gian n·ªôp ƒë∆°n
- ProcessedAt (DateTime, nullable) - th·ªùi gian x·ª≠ l√Ω
- ProcessedById (Guid, nullable, FK to User) - admin x·ª≠ l√Ω
- CreatedAt, UpdatedAt, IsDeleted, IsActive (BaseEntity fields)

SpecialtyShopApplicationStatus Enum:
------------------------------------
- Pending = 0 (Ch·ªù x·ª≠ l√Ω)
- Approved = 1 (ƒê√£ duy·ªát)
- Rejected = 2 (T·ª´ ch·ªëi)

Role Updates:
-------------
Th√™m role m·ªõi: "Specialty Shop" v√†o Constants v√† DataSeeder

üåê API ENDPOINTS
================

USER SIDE (AccountController):
------------------------------
POST /api/Account/specialty-shop-application
- Authorization: Bearer token, Role "User"
- Body: SubmitSpecialtyShopApplicationDto (multipart/form-data)
- Function: User n·ªôp ƒë∆°n ƒëƒÉng k√Ω specialty shop
- Response: Confirmation message

GET /api/Account/my-specialty-shop-application
- Authorization: Bearer token, Role "User"
- Function: Xem tr·∫°ng th√°i ƒë∆°n ƒëƒÉng k√Ω c·ªßa m√¨nh
- Response: SpecialtyShopApplicationDto ho·∫∑c null

ADMIN SIDE (CmsController):
---------------------------
GET /api/Cms/specialty-shop-applications
- Authorization: Bearer token, Role "Admin"
- Query params: status, pageIndex, pageSize
- Function: L·∫•y danh s√°ch ƒë∆°n ƒëƒÉng k√Ω specialty shop
- Response: Paginated list of SpecialtyShopApplicationSummaryDto

GET /api/Cms/specialty-shop-applications/{id}
- Authorization: Bearer token, Role "Admin"
- Function: Xem chi ti·∫øt ƒë∆°n ƒëƒÉng k√Ω
- Response: SpecialtyShopApplicationDto with full details

PUT /api/Cms/specialty-shop-applications/{id}/approve
- Authorization: Bearer token, Role "Admin"
- Function: Duy·ªát ƒë∆°n ƒëƒÉng k√Ω specialty shop
- Process: User role ‚Üí "Specialty Shop", t·∫°o SpecialtyShop entity
- Response: Success message

PUT /api/Cms/specialty-shop-applications/{id}/reject
- Authorization: Bearer token, Role "Admin"
- Body: RejectSpecialtyShopApplicationDto (reason)
- Function: T·ª´ ch·ªëi ƒë∆°n ƒëƒÉng k√Ω v·ªõi l√Ω do
- Response: Success message

üìù DTOs DESIGN
==============

SubmitSpecialtyShopApplicationDto:
----------------------------------
- ShopName (string, required)
- ShopDescription (string, optional)
- BusinessLicense (string, required)
- Location (string, required)
- PhoneNumber (string, required)
- Email (string, required, email format)
- Website (string, optional, URL format)
- ShopType (string, optional)
- BusinessDocuments (IFormFile[], optional)

SpecialtyShopApplicationDto:
----------------------------
- Id (Guid)
- ShopName (string)
- ShopDescription (string)
- BusinessLicense (string)
- Location (string)
- PhoneNumber (string)
- Email (string)
- Website (string)
- ShopType (string)
- BusinessDocuments (List<string>) - file URLs
- Status (SpecialtyShopApplicationStatus)
- RejectionReason (string)
- SubmittedAt (DateTime)
- ProcessedAt (DateTime?)
- UserInfo (UserSummaryDto)
- ProcessedByInfo (UserSummaryDto?)

SpecialtyShopApplicationSummaryDto:
-----------------------------------
- Id (Guid)
- ShopName (string)
- Location (string)
- Status (SpecialtyShopApplicationStatus)
- SubmittedAt (DateTime)
- UserName (string)
- UserEmail (string)

RejectSpecialtyShopApplicationDto:
----------------------------------
- Reason (string, required)

‚öôÔ∏è BUSINESS LOGIC FLOW
======================

1. SUBMIT APPLICATION (User):
-----------------------------
a. Validate user role = "User"
b. Validate input data (required fields, email format, etc.)
c. Check duplicate: user ch∆∞a c√≥ ƒë∆°n pending
d. Upload business documents to file storage
e. Create ShopApplication entity v·ªõi status = Pending
f. Send confirmation email to user
g. Return success response

2. ADMIN REVIEW PROCESS:
------------------------
a. Admin login to CMS
b. Navigate to Shop Applications management
c. View list of pending applications
d. Click v√†o application ƒë·ªÉ xem chi ti·∫øt
e. Review business documents v√† th√¥ng tin
f. Make decision: Approve ho·∫∑c Reject

3. APPROVE APPLICATION (Admin):
-------------------------------
a. Validate application status = Pending
b. Begin database transaction:
   - Get/Create "Specialty Shop" role
   - Update user.RoleId = specialtyShopRole.Id
   - Create SpecialtyShop entity from application data:
     * ShopName = app.ShopName
     * Description = app.ShopDescription
     * Location = app.Location
     * PhoneNumber = app.PhoneNumber
     * Email = app.Email
     * Website = app.Website
     * ShopType = app.ShopType
     * UserId = app.UserId
     * CreatedById = app.UserId
     * IsActive = true
     * IsShopActive = true
   - Update application:
     * Status = Approved
     * ProcessedAt = DateTime.Now
     * ProcessedById = currentAdminId
c. Commit transaction
d. Send approval email notification
e. Return success response

4. REJECT APPLICATION (Admin):
------------------------------
a. Validate application status = Pending
b. Update application:
   - Status = Rejected
   - RejectionReason = provided reason
   - ProcessedAt = DateTime.Now
   - ProcessedById = currentAdminId
c. Send rejection email with reason
d. Return success response

üîê SECURITY & AUTHORIZATION
===========================

Role Management:
----------------
- Constants.RoleSpecialtyShopName = "Specialty Shop"
- DataSeeder: th√™m role "Specialty Shop" v√†o database
- Authorization attributes update

Controller Authorization:
-------------------------
- AccountController.SubmitSpecialtyShopApplication: [Authorize(Roles = "User")]
- CmsController.SpecialtyShopApplications: [Authorize(Roles = "Admin")]
- SpecialtyShopController: [Authorize(Roles = "Admin,Tour Company,Specialty Shop")]

Service Authorization:
----------------------
- SpecialtyShopService: Specialty Shop ch·ªâ c√≥ th·ªÉ CRUD specialty shop c·ªßa m√¨nh
- Ownership check: specialtyShop.UserId == currentUserId
- Admin v√† Tour Company c√≥ th·ªÉ CRUD t·∫•t c·∫£ specialty shops

File Upload Security:
---------------------
- Validate file types (PDF, JPG, PNG only)
- File size limits (max 5MB per file)
- Virus scanning (if available)
- Secure file storage with unique names

üìß EMAIL NOTIFICATIONS
======================

1. Application Submitted:
-------------------------
Subject: "ƒê∆°n ƒëƒÉng k√Ω Specialty Shop ƒë√£ ƒë∆∞·ª£c ti·∫øp nh·∫≠n"
Content: 
- X√°c nh·∫≠n ƒë√£ nh·∫≠n ƒë∆°n
- Th·ªùi gian x·ª≠ l√Ω d·ª± ki·∫øn (3-5 ng√†y l√†m vi·ªác)
- Th√¥ng tin li√™n h·ªá support

2. Application Approved:
------------------------
Subject: "Ch√∫c m·ª´ng! ƒê∆°n ƒëƒÉng k√Ω Specialty Shop ƒë√£ ƒë∆∞·ª£c duy·ªát"
Content:
- Th√¥ng b√°o approval
- H∆∞·ªõng d·∫´n ƒëƒÉng nh·∫≠p v·ªõi role m·ªõi
- Link ƒë·∫øn shop management dashboard
- Th√¥ng tin li√™n h·ªá support

3. Application Rejected:
------------------------
Subject: "ƒê∆°n ƒëƒÉng k√Ω Specialty Shop c·∫ßn b·ªï sung th√¥ng tin"
Content:
- Th√¥ng b√°o rejection
- L√Ω do c·ª• th·ªÉ t·ª´ admin
- H∆∞·ªõng d·∫´n n·ªôp l·∫°i ƒë∆°n
- Th√¥ng tin li√™n h·ªá support

üéØ USER JOURNEY COMPLETE
========================

Step 1: User Registration
-------------------------
- User truy c·∫≠p website
- ƒêƒÉng k√Ω t√†i kho·∫£n v·ªõi email/OTP verification
- Role m·∫∑c ƒë·ªãnh: "User"

Step 2: SpecialtyShop Application
----------------------------------
- User login v√†o account
- Navigate to "ƒêƒÉng k√Ω Specialty Shop"
- Fill form v·ªõi th√¥ng tin specialty shop v√† business documents
- Submit application
- Nh·∫≠n email confirmation

Step 3: Admin Processing
------------------------
- Admin login to CMS
- Review pending specialty shop applications
- Check business documents v√† th√¥ng tin
- Make approve/reject decision
- Send notification email

Step 4: Post-Approval
---------------------
- User nh·∫≠n email approval
- Login l·∫°i ‚Üí role ƒë√£ th√†nh "Specialty Shop"
- Access specialty shop management features
- Update specialty shop information
- Participate in tour timeline
- Receive bookings from tours

‚úÖ SPECIALTY SHOP PERMISSIONS
=============================

SpecialtyShop Management:
-------------------------
- View v√† edit specialty shop information
- Upload specialty shop images
- Update opening hours
- Set specialty shop status (open/closed)
- Manage specialty shop products/services

Tour Integration:
-----------------
- Participate in tour timeline
- Receive booking notifications
- Confirm/decline tour visits
- Provide tour group services

Analytics & Reports:
--------------------
- View specialty shop visit statistics
- Revenue reports from tours
- Customer feedback v√† ratings
- Performance metrics

üóìÔ∏è SPECIALTYSHOP TIMELINE INTEGRATION
=====================================

Timeline Assignment Process:
----------------------------
1. Tour Company t·∫°o TourDetails cho TourTemplate
2. Tour Company design timeline cho TourDetails
3. Trong timeline, Tour Company c√≥ th·ªÉ:
   - Add TimelineItem v·ªõi SpecialtyShopId ƒë·ªÉ l·∫•y th√¥ng tin specialty shop
   - Set th·ªùi gian visit specialty shop (start time, duration)
   - Set m√¥ t·∫£ ho·∫°t ƒë·ªông t·∫°i specialty shop
   - Timeline s·∫Ω hi·ªÉn th·ªã th√¥ng tin specialty shop (t√™n, ƒë·ªãa ch·ªâ, SƒêT, etc.)

Timeline Item Structure:
------------------------
TimelineItem Entity (existing):
- Id (Guid, PK)
- TourDetailsId (Guid, FK)
- SpecialtyShopId (Guid, FK) - QUAN TR·ªåNG: link ƒë·∫øn SpecialtyShop ƒë·ªÉ l·∫•y th√¥ng tin
- Order (int) - th·ª© t·ª± trong timeline
- StartTime (TimeSpan) - gi·ªù b·∫Øt ƒë·∫ßu
- Duration (TimeSpan) - th·ªùi gian ·ªü specialty shop
- Title (string) - ti√™u ƒë·ªÅ ho·∫°t ƒë·ªông
- Description (string) - m√¥ t·∫£ chi ti·∫øt
- Notes (string) - ghi ch√∫ cho tour guide

SpecialtyShop Timeline APIs (Simplified):
-----------------------------------------
GET /api/SpecialtyShop/my-timeline-usage
- Authorization: Role "Specialty Shop"
- Function: Xem c√°c tour ƒë√£ s·ª≠ d·ª•ng th√¥ng tin specialty shop m√¨nh
- Response: List of timeline items c√≥ SpecialtyShopId = current specialty shop

Tour Company Timeline APIs:
---------------------------
GET /api/SpecialtyShop/timeline
- Authorization: Role "Tour Company", "Admin"
- Query: pageIndex, pageSize, textSearch, location, shopType, status
- Function: Browse specialty shops ƒë·ªÉ ch·ªçn cho timeline
- Response: Paginated list of SpecialtyShopResponseDto

GET /api/SpecialtyShop/timeline/{id}
- Authorization: Role "Tour Company", "Admin"
- Function: L·∫•y th√¥ng tin chi ti·∫øt specialty shop cho timeline
- Response: SpecialtyShopResponseDto

POST /api/TourDetails/{id}/timeline-items
- Authorization: Role "Tour Company"
- Body: CreateTimelineItemDto (include SpecialtyShopId)
- Function: Th√™m specialty shop v√†o timeline (ch·ªâ ƒë·ªÉ l·∫•y th√¥ng tin)
- Response: TimelineItemDto with specialty shop info

PUT /api/TourDetails/timeline-items/{id}
- Authorization: Role "Tour Company"
- Body: UpdateTimelineItemDto
- Function: Update timeline item (change specialty shop, time, etc.)
- Response: Success/failure

Timeline Business Logic (Simplified):
-------------------------------------
1. Tour Company Design Timeline:
   - Select TourDetails c·∫ßn design timeline
   - Browse available specialty shops by location/type/rating
   - Add specialty shops to timeline ƒë·ªÉ l·∫•y th√¥ng tin specialty shop
   - Set th·ªùi gian visit v√† m√¥ t·∫£ ho·∫°t ƒë·ªông
   - Timeline hi·ªÉn th·ªã: th·ªùi gian + th√¥ng tin specialty shop + m√¥ t·∫£

2. Timeline Display:
   - M·ªói timeline item hi·ªÉn th·ªã:
     * Th·ªùi gian: 10:30 - 11:00
     * Ho·∫°t ƒë·ªông: "Mua s·∫Øm ƒë·∫∑c s·∫£n"
     * SpecialtyShop: "ƒê·∫∑c S·∫£n T√¢y Ninh ABC"
     * ƒê·ªãa ch·ªâ: "123 ƒê∆∞·ªùng ABC, T√¢y Ninh"
     * SƒêT: "0123456789"
     * Ghi ch√∫: "Specialty shop chuy√™n b√°nh tr√°ng, m·∫Øm ru·ªëc"

3. Timeline Validation (Basic):
   - Validate timeline order h·ª£p l√Ω
   - Check total duration fits tour time
   - Ensure specialty shop information complete

Timeline DTOs (Simplified):
---------------------------
CreateTimelineItemDto:
- TourDetailsId (Guid)
- SpecialtyShopId (Guid, optional) - ƒë·ªÉ l·∫•y th√¥ng tin specialty shop
- Order (int)
- StartTime (TimeSpan)
- Duration (TimeSpan)
- Title (string)
- Description (string)

TimelineItemDto:
- Id (Guid)
- Order (int)
- StartTime (TimeSpan)
- Duration (TimeSpan)
- Title (string)
- Description (string)
- SpecialtyShop (SpecialtyShopResponseDto, nullable) - th√¥ng tin specialty shop n·∫øu c√≥

TimelineUsageDto:
- TimelineItemId (Guid)
- TourDetailsTitle (string)
- TourDate (DateTime)
- StartTime (TimeSpan)
- Duration (TimeSpan)
- ActivityDescription (string)
- TourCompanyInfo (UserSummaryDto)

SpecialtyShop Timeline Workflow (Simplified):
--------------------------------------------
1. Tour Company creates TourDetails
2. Tour Company designs timeline:
   - Browse available specialty shops by location/type/rating
   - Select specialty shops ƒë·ªÉ l·∫•y th√¥ng tin cho timeline
   - Set visit time v√† duration
   - Add activity description
   - Timeline hi·ªÉn th·ªã th√¥ng tin specialty shop ƒë√£ ch·ªçn
3. Timeline ƒë∆∞·ª£c publish v·ªõi th√¥ng tin specialty shop
4. Tour guide nh·∫≠n timeline v·ªõi ƒë·∫ßy ƒë·ªß th√¥ng tin specialty shop
5. During tour execution:
   - Tour guide follows timeline
   - Visit specialty shops theo th√¥ng tin trong timeline
   - SpecialtyShop information helps guide locate v√† contact

SpecialtyShop Information Usage:
-------------------------------
Timeline s·∫Ω hi·ªÉn th·ªã th√¥ng tin specialty shop:
- T√™n specialty shop
- ƒê·ªãa ch·ªâ ch√≠nh x√°c
- S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá
- Lo·∫°i specialty shop (Souvenir, Food, Craft...)
- Gi·ªù m·ªü c·ª≠a (n·∫øu c√≥)
- Ghi ch√∫ ƒë·∫∑c bi·ªát

SpecialtyShop Timeline Dashboard (Simplified):
----------------------------------------------
For Specialty Shop owners:
- View timeline usage: xem c√°c tour ƒë√£ s·ª≠ d·ª•ng th√¥ng tin specialty shop
- Statistics: s·ªë l·∫ßn ƒë∆∞·ª£c include trong timeline
- Tour company contacts: danh s√°ch tour company ƒë√£ s·ª≠ d·ª•ng
- SpecialtyShop information accuracy: ƒë·∫£m b·∫£o th√¥ng tin specialty shop lu√¥n ch√≠nh x√°c

üîß TECHNICAL IMPLEMENTATION
===========================

Required Files for SpecialtyShop Registration:
----------------------------------------------
1. Entities/SpecialtyShopApplication.cs
2. Enums/SpecialtyShopApplicationStatus.cs
3. DTOs/Request/SubmitSpecialtyShopApplicationDto.cs
4. DTOs/Response/SpecialtyShopApplicationDto.cs
5. Services/Interface/ISpecialtyShopApplicationService.cs
6. Services/SpecialtyShopApplicationService.cs
7. Controllers/AccountController.cs (add endpoints)
8. Controllers/CmsController.cs (add endpoints)
9. Repositories/Interface/ISpecialtyShopApplicationRepository.cs
10. Repositories/SpecialtyShopApplicationRepository.cs
11. EntityConfigurations/SpecialtyShopApplicationConfiguration.cs
12. Migrations/AddSpecialtyShopApplicationTable.cs

Required Files for Timeline Integration:
---------------------------------------
13. Enums/TimelineItemStatus.cs
14. DTOs/Request/CreateTimelineItemDto.cs
15. DTOs/Request/UpdateTimelineItemDto.cs
16. DTOs/Response/TimelineItemDto.cs
17. DTOs/Response/TimelineOpportunityDto.cs
18. Services/Interface/ITimelineService.cs
19. Services/TimelineService.cs
20. Controllers/SpecialtyShopController.cs (add timeline endpoints)
21. Controllers/TourDetailsController.cs (add timeline endpoints)
22. Repositories/Interface/ITimelineItemRepository.cs (update existing)
23. Repositories/TimelineItemRepository.cs (update existing)

Database Schema Updates:
------------------------
Existing TimelineItem table ƒë√£ c√≥:
- SpecialtyShopId (Guid, FK to SpecialtyShop) - ALREADY EXISTS - ƒë·ªÉ link th√¥ng tin specialty shop

No additional columns needed for TimelineItem.

SpecialtyShop table ƒë√£ c√≥ ƒë·∫ßy ƒë·ªß fields:
- OpeningHours (string) - gi·ªù m·ªü c·ª≠a ƒë·ªÉ hi·ªÉn th·ªã trong timeline
- IsActive (bool) - specialty shop c√≥ ƒëang ho·∫°t ƒë·ªông kh√¥ng
- IsShopActive (bool) - specialty shop c√≥ ƒëang m·ªü c·ª≠a kh√¥ng

Migration Scripts:
------------------
1. AddSpecialtyShopApplicationTable.cs
2. AddSpecialtyShopRole.cs (ALREADY DONE)
3. UpdateTimelineItemForSpecialtyShop.cs (ALREADY DONE - SpecialtyShopId exists)

Service Registration Updates:
-----------------------------
Program.cs additions:
- builder.Services.AddScoped<ISpecialtyShopApplicationService, SpecialtyShopApplicationService>();
- builder.Services.AddScoped<ISpecialtyShopService, SpecialtyShopService>(); (ALREADY DONE)
- builder.Services.AddScoped<ITimelineService, TimelineService>();

UnitOfWork updates:
- ISpecialtyShopApplicationRepository SpecialtyShopApplicationRepository { get; }

AutoMapper Profile Updates:
---------------------------
- CreateMap<SubmitSpecialtyShopApplicationDto, SpecialtyShopApplication>();
- CreateMap<SpecialtyShopApplication, SpecialtyShopApplicationDto>();
- CreateMap<CreateTimelineItemDto, TimelineItem>();
- CreateMap<TimelineItem, TimelineItemDto>()
    .ForMember(dest => dest.SpecialtyShop, opt => opt.MapFrom(src => src.SpecialtyShop));

Key Implementation Notes:
-------------------------
1. TimelineItem.SpecialtyShopId relationship ALREADY EXISTS in current schema
2. SpecialtyShop information integration ALREADY IMPLEMENTED
3. Timeline endpoints for SpecialtyShop ALREADY IMPLEMENTED
4. SpecialtyShopService with timeline methods ALREADY IMPLEMENTED
5. Authorization for Admin/Tour Company ALREADY IMPLEMENTED
6. Pagination and filtering ALREADY IMPLEMENTED
7. API testing COMPLETED and WORKING

Timeline Service Key Methods (IMPLEMENTED):
-------------------------------------------
- GetShopsForTimelineAsync(pageIndex, pageSize, textSearch, location, shopType, status)
- GetShopByIdForTimelineAsync(specialtyShopId)
- Timeline integration through SpecialtyShopService

SpecialtyShop Controller Timeline Endpoints (IMPLEMENTED):
----------------------------------------------------------
GET /api/SpecialtyShop/timeline - Browse specialty shops cho timeline (WORKING)
GET /api/SpecialtyShop/timeline/{id} - Get specialty shop by ID cho timeline (WORKING)

TourDetails Controller Timeline Endpoints (TO BE IMPLEMENTED):
--------------------------------------------------------------
POST /api/TourDetails/{id}/timeline-items - Add specialty shop v√†o timeline
PUT /api/TourDetails/timeline-items/{id} - Update timeline item
DELETE /api/TourDetails/timeline-items/{id} - Remove specialty shop kh·ªèi timeline

üìã SPECIALTYSHOP TIMELINE INTEGRATION WORKFLOW EXAMPLE
======================================================

Scenario: Tour Company t·∫°o timeline cho "T√¢y Ninh 1 Day Tour"
-------------------------------------------------------------

Step 1: Tour Company Design Timeline
------------------------------------
1. Tour Company login, ch·ªçn TourDetails "T√¢y Ninh 1 Day Tour - Saturday"
2. Click "Design Timeline"
3. Timeline editor hi·ªÉn th·ªã:
   - 08:00-09:00: Kh·ªüi h√†nh t·ª´ TP.HCM
   - 09:00-10:30: ƒê·ªÅn Cao ƒê√†i
   - 10:30-11:00: [EMPTY SLOT] - c·∫ßn th√™m specialty shop
   - 11:00-12:00: N√∫i B√† ƒêen
   - 12:00-13:00: [EMPTY SLOT] - c·∫ßn th√™m specialty shop ƒÉn tr∆∞a
   - 13:00-15:00: ƒê·ªãa ƒë·∫°o C·ªß Chi
   - 15:00-15:30: [EMPTY SLOT] - c·∫ßn th√™m specialty shop ƒë·∫∑c s·∫£n
   - 15:30-17:00: V·ªÅ TP.HCM

Step 2: Add SpecialtyShop to Timeline Slot 1 (10:30-11:00)
----------------------------------------------------------
1. Tour Company click v√†o slot 10:30-11:00
2. System call API: GET /api/SpecialtyShop/timeline?location=TayNinh&shopType=Souvenir
3. System hi·ªÉn th·ªã "Available SpecialtyShops":
   - Filter: Location = "T√¢y Ninh", ShopType = "Souvenir"
   - Results:
     * "ƒê·∫∑c S·∫£n T√¢y Ninh ABC" - Rating 4.5
     * "C·ª≠a H√†ng L∆∞u Ni·ªám XYZ" - Rating 4.2
     * "SpecialtyShop ƒê·∫∑c S·∫£n 123" - Rating 4.8
4. Tour Company ch·ªçn "SpecialtyShop ƒê·∫∑c S·∫£n 123"
5. Fill timeline details:
   - Title: "Mua s·∫Øm ƒë·∫∑c s·∫£n ƒë·ªãa ph∆∞∆°ng"
   - Description: "Kh√°ch tham quan v√† mua ƒë·∫∑c s·∫£n T√¢y Ninh"
   - Expected Guests: 25 ng∆∞·ªùi
   - Duration: 30 ph√∫t
6. Click "Add to Timeline"

Step 3: System Processing
-------------------------
1. System t·∫°o TimelineItem:
   - TourDetailsId = [tour-id]
   - SpecialtyShopId = [specialty-shop-123-id] - ƒë·ªÉ l·∫•y th√¥ng tin specialty shop
   - Order = 3
   - StartTime = 10:30
   - Duration = 30 minutes
   - Title = "Mua s·∫Øm ƒë·∫∑c s·∫£n ƒë·ªãa ph∆∞∆°ng"
   - Description = "Kh√°ch tham quan v√† mua ƒë·∫∑c s·∫£n T√¢y Ninh"
2. System load th√¥ng tin specialty shop t·ª´ database:
   - ShopName: "SpecialtyShop ƒê·∫∑c S·∫£n 123"
   - Location: "456 ƒê∆∞·ªùng DEF, T√¢y Ninh"
   - PhoneNumber: "0987654321"
   - OpeningHours: "8:00-18:00"
   - ShopType: "Souvenir"
3. Timeline item hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß th√¥ng tin

Step 4: Timeline Information Display
-----------------------------------
Timeline item hi·ªÉn th·ªã:
- 10:30-11:00: Mua s·∫Øm ƒë·∫∑c s·∫£n ƒë·ªãa ph∆∞∆°ng
- SpecialtyShop: SpecialtyShop ƒê·∫∑c S·∫£n 123
- ƒê·ªãa ch·ªâ: 456 ƒê∆∞·ªùng DEF, T√¢y Ninh
- SƒêT: 0987654321
- Gi·ªù m·ªü c·ª≠a: 8:00-18:00
- Lo·∫°i: Souvenir
- Ghi ch√∫: Kh√°ch tham quan v√† mua ƒë·∫∑c s·∫£n T√¢y Ninh

No confirmation needed - th√¥ng tin specialty shop ƒë√£ s·∫µn s√†ng s·ª≠ d·ª•ng

Step 5: Complete Timeline
-------------------------
Tour Company ti·∫øp t·ª•c add specialty shops cho c√°c slot c√≤n l·∫°i:
- 12:00-13:00: "Nh√† H√†ng C∆°m T·∫•m T√¢y Ninh" (th√¥ng tin ƒë√£ load)
- 15:00-15:30: "SpecialtyShop B√°nh Tr√°ng N∆∞·ªõng" (th√¥ng tin ƒë√£ load)

Final Timeline v·ªõi th√¥ng tin specialty shop:
- 08:00-09:00: Kh·ªüi h√†nh t·ª´ TP.HCM
- 09:00-10:30: ƒê·ªÅn Cao ƒê√†i
- 10:30-11:00: SpecialtyShop ƒê·∫∑c S·∫£n 123 üìç (456 ƒê∆∞·ªùng DEF, SƒêT: 0987654321)
- 11:00-12:00: N√∫i B√† ƒêen
- 12:00-13:00: Nh√† H√†ng C∆°m T·∫•m T√¢y Ninh üìç (789 ƒê∆∞·ªùng GHI, SƒêT: 0123456789)
- 13:00-15:00: ƒê·ªãa ƒë·∫°o C·ªß Chi
- 15:00-15:30: SpecialtyShop B√°nh Tr√°ng N∆∞·ªõng üìç (321 ƒê∆∞·ªùng JKL, SƒêT: 0555666777)
- 15:30-17:00: V·ªÅ TP.HCM

Step 6: Tour Execution Day
--------------------------
1. Tour Guide nh·∫≠n timeline v·ªõi ƒë·∫ßy ƒë·ªß th√¥ng tin specialty shop
2. 10:25 - Tour bus ƒë·∫øn ƒë·ªãa ch·ªâ "456 ƒê∆∞·ªùng DEF, T√¢y Ninh"
3. Tour Guide c√≥ th·ªÉ g·ªçi SƒêT 0987654321 n·∫øu c·∫ßn
4. 10:30-11:00 - Kh√°ch tham quan "SpecialtyShop ƒê·∫∑c S·∫£n 123"
5. 11:00 - Tour bus ti·∫øp t·ª•c ƒë·∫øn N√∫i B√† ƒêen theo timeline

Step 7: SpecialtyShop Usage Analytics (Optional)
------------------------------------------------
SpecialtyShop Owner c√≥ th·ªÉ xem:
- Timeline usage: specialty shop ƒë∆∞·ª£c s·ª≠ d·ª•ng trong bao nhi√™u tour
- Tour companies: danh s√°ch tour company ƒë√£ s·ª≠ d·ª•ng th√¥ng tin
- Contact frequency: s·ªë l·∫ßn ƒë∆∞·ª£c li√™n h·ªá
- Information accuracy: ƒë·∫£m b·∫£o th√¥ng tin specialty shop lu√¥n ch√≠nh x√°c

Benefits for All Parties:
-------------------------
Tour Company:
- Timeline c√≥ ƒë·∫ßy ƒë·ªß th√¥ng tin specialty shop
- D·ªÖ d√†ng li√™n h·ªá v√† ƒë·ªãnh v·ªã specialty shop
- T·ªëi ∆∞u th·ªùi gian tour planning

SpecialtyShop Owner:
- Th√¥ng tin specialty shop ƒë∆∞·ª£c s·ª≠ d·ª•ng ch√≠nh th·ª©c
- Potential marketing exposure
- Professional listing trong tour system

Tourists:
- Tour guide c√≥ th√¥ng tin ch√≠nh x√°c v·ªÅ specialty shop
- Efficient navigation v√† contact
- Better tour experience

System:
- Simple information linking
- No complex confirmation workflow
- Easy specialty shop information management
- Clean timeline display

üéØ CURRENT IMPLEMENTATION STATUS (UPDATED 2025-06-16)
======================================================

‚úÖ COMPLETED FEATURES:
----------------------
1. SpecialtyShop Entity - IMPLEMENTED
2. SpecialtyShopService - IMPLEMENTED
3. SpecialtyShopController - IMPLEMENTED
4. Timeline Integration APIs - IMPLEMENTED & TESTED
5. Authorization (Admin/Tour Company) - IMPLEMENTED & TESTED
6. Pagination & Filtering - IMPLEMENTED & TESTED
7. Database Schema - IMPLEMENTED (SpecialtyShop table exists)
8. Shop ‚Üí SpecialtyShop Migration - COMPLETED
9. API Testing - COMPLETED (all endpoints working)

üîÑ PENDING FEATURES:
-------------------
1. SpecialtyShopApplication Entity - TO BE IMPLEMENTED
2. SpecialtyShopApplicationService - TO BE IMPLEMENTED
3. Shop Registration Flow - TO BE IMPLEMENTED
4. Admin CMS for Application Management - TO BE IMPLEMENTED
5. Email Notifications - TO BE IMPLEMENTED
6. TourDetails Timeline Integration - TO BE IMPLEMENTED

üìä API ENDPOINTS STATUS:
-----------------------
‚úÖ GET /api/SpecialtyShop/timeline - WORKING
‚úÖ GET /api/SpecialtyShop/timeline/{id} - WORKING
‚úÖ GET /api/SpecialtyShop/active - WORKING
‚úÖ GET /api/SpecialtyShop/paged - WORKING
‚úÖ GET /api/SpecialtyShop/search - WORKING
‚úÖ GET /api/SpecialtyShop/by-type/{type} - WORKING
‚úÖ GET /api/SpecialtyShop/by-rating/{rating} - WORKING
‚ùå POST /api/Account/specialty-shop-application - TO BE IMPLEMENTED
‚ùå GET /api/Cms/specialty-shop-applications - TO BE IMPLEMENTED

üóÑÔ∏è DATABASE STATUS:
-------------------
‚úÖ SpecialtyShop table - EXISTS & WORKING
‚úÖ TimelineItem.SpecialtyShopId - EXISTS & WORKING
‚ùå SpecialtyShopApplication table - TO BE CREATED
‚úÖ Role "Specialty Shop" - EXISTS
‚úÖ All migrations applied successfully

üîß TECHNICAL DEBT:
------------------
‚úÖ Shop entity - REMOVED
‚úÖ ShopService - REMOVED
‚úÖ ShopController - REMOVED
‚úÖ Shop DTOs - REMOVED (kept compatible ones for timeline)
‚úÖ Shop mappings - REMOVED
‚úÖ Build errors - RESOLVED
‚úÖ API testing - COMPLETED

================================================================================
                                    END
================================================================================
